# Микрофронтенд

Не прошло и 4 летк как микросервисная идея добралась и до веба. В рядах фронтендеров кого, только нет. Люди приходят из обсолютно разных областей технологий и тянут от туда самое лучшее. И спасибо им за это.

## Чаво

Смотрите, большинство проектов и скорее всего ваш в том числе. Имеет микросервисы на бэкенде, и молит на фронте. И на это больно смотреть. Само собой мы не безрукие и у нас есть лучшие интсрументы для работы с монорепой [lernajs](https://github.com/lerna/lerna). Так что не так страшно скажете вы.

Но а как масштабировать фронтенд?

Тоесть у нас есть продукт, мы хотим удвоить его функциональность. Банальное удвоение функциональности приведет к огромной очредеи комитов в гите, с ветками станет трудновато работать. Так что простейшим выходом будет деградировать до TFS, или SVN. Не обязательно на них переходить, просто принцип работы с гитом станет схож.

А что если мы удвоили функциональность, нам дали гору денег и сказали: "Ребята, давайте утроим". Скорее всего наши инструменты, редакторы, билдеры, начнут димиться. Мы начнем увеличивать лимиты для работы с файловой системой, что бы наши билдеры могли продолжать делать свою грязную работу.

Рано или поздно но CPU / RAM на ноутбуках у нас закончиться, мы переедем за Desktop.... Но это будет уже совсем другая история.

Так вот, я опустил еще проблемму организации фронтендеров на таком ужасном проекте. Например если бы это был Booking, OneTwoTrip, Agoda, они бы сказали. Ну ребята. Епата... Горизонтальные и вертикальные команды.

Где горизонтальные, занимаются shared компонентами и их внедрением на различных страницах. А вертикальные отвечают за фичи на одной конткретной странице. Причем команды у нас маленькие скажем до 4 человек. Это юнит. 1 (FE, BE, Design, QA). Юнит в единицу времени делает одну фичу.

Так себе решение, ну почему бы и нет. Но скажем у нас 100 разных страниц. 400 человек, и это минимум. Хех.

## И как теперь жить

А что если мы возьмем, и попытаемся разделить сам проект на части? Врдяли если у нас один проект, и мы в нем имеем одну функциональность, но прям жирную, которая размазанна на 100 MB фронтенд кода...

К примеру попробуйте представить форму заказа кросовок c доставкой надом. Но форма очень сложная. Такая сложная, что для ее разработки нам подребовалось к примеру 40 человек из UI команды.

Это должна быть форма на шагов 200. Такое сложно представить...

Но вот более простой пример, более веселая задача. Возьмите сложный сайт, например jira. И попытайтесь мысленно разнести его на части.

Место где вы думаете и разносите jira на части....

У меня получилось следующее: авториазция, борд с карточками, формы - таблицы создания карточек, дашборды и график. И вот в первом приближении для работы над jira мы можем использовать 5 команд UI команд и это будет оптимальная гранулярность. Для этого набора функциональности.

Давайте дальше...

А что если мы возьмем, да и разнесем сам UI jira на 5 проектов, которые можно независимо разрабатывать, независимыми командами из FE, BE, QA, Design. Тоесть у нас безусловно будут общие компоненты, нам дополнитольно надо будет вынести из UI, бизенс логику,в отдельную либу. Что бы нам ненадо было бы склеивать приложение в 1-о при финальном деплое. Это дополнительный геморой - зачем он нам.

Нам проще сделать:

                                             проект1

Bussines Logic1 \    Shared Init Template (общие модалочки, и какие нибудь, футер, header) \
Bussines Logic  - Shared code (посути UI - less приложение) --------------------------------- UI
Bussines Logic2 /                            Shared Component1 /
                                             Shared Component2 /
                                             Shared Component3 /

                                             проект2

Bussines Logic1 \    Shared Init Template (общие модалочки, и какие нибудь, футер, header) \
Bussines Logic  - Shared code (посути UI - less приложение) --------------------------------- UI
Bussines Logic2 /                            Shared Component1 /
                                             Shared Component2 /
                                             Shared Component3 /

Я выше писал про лерну, так вот она позволяет свести все сложности с запуском подключением, версионированием NPM модулей к нулю. Обратите внимание, что я не говорю про UI kit я говорю про шаред компоненты. Каждый компонент лежит отдельно в NPM. Это позволяет собирать токие чанки в бандлах.

Бизнес логику нужно шарить, что бы одинковое окружение во всех частях кода. Но важно разделять задачи на UI, даже на уровне дизайна. Например что бы отредатировать или создать карточку, тебе надо перейти в приложение отвечающее за карточки. Либо запустить зашаренный диалог. Тоесть на такие проекты мы накладываем даже в дизайне SOLID, и доп ограничения.

И знаете что рано или поздно это станет мейнстримом.

Во первых, у вас итоговый проект становится действительно модульным, во вторых, вы будете вынужденны использовать service workers чтобы шэрить стэйт между апами.

В третьих вы можете продавать назный набор фичей.

В четвертых, это капец как легко масштабируется.

Смотрите. Вы вместо того что бы усложнять процессы с увеличение сложности и кол-ва вовлеченных людей, вы делаете декомпозицию организации, и продолжаете работать так же как и раньше. Только теперь возникает перестановка у менеджеров, появляются продукты в дробных проектах. И это процесс можно повторить если какой проект подрос и опять реализвал в себе N проектов. Но для обычного кодера Васи, все по прежнему. Он как пилил фичи так и пилит.

Важно при таком подходе сохранить коммуникацию между командами, что бы обмениваться опытом. Прикольней всего это дать прокетам волю, и вскоре появится команда у которой и прокет и развитие будут лучше других. Важно замотивировать ее поделиться секретом успеха с другими.

Как я писал во главе комьюнити, мы все братаны о коду, и должны стремиться помогать друг другу. Только так мы можем быть уверены в завтрашнем дне.